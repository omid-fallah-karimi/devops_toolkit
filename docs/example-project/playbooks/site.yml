---
# Main site playbook - Complete server setup
# Usage: ansible-playbook -i inventory/production/hosts playbooks/site.yml

- name: Complete Server Setup
  hosts: all
  become: true
  gather_facts: true

  pre_tasks:
    - name: Display setup information
      ansible.builtin.debug:
        msg: |
          Setting up: {{ inventory_hostname }}
          OS: {{ ansible_distribution }} {{ ansible_distribution_version }}

  roles:
    # 1. Set timezone
    - role: omid_fallah_karimi.devops_toolkit.set_timezone

    # 2. Install base packages
    - role: omid_fallah_karimi.devops_toolkit.install_packages
      vars:
        packages: "{{ base_packages }}"

    # 3. Install Docker
    - role: omid_fallah_karimi.devops_toolkit.install_docker

  post_tasks:
    - name: Display completion message
      ansible.builtin.debug:
        msg: "âœ“ Server setup completed for {{ inventory_hostname }}"
